<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="twitter:description" content="Learn how to build and leverage feature flags (or feature toggles) in React to improve both the development/release workflow and the user experience."/><meta data-react-helmet="true" name="twitter:title" content="Build feature flags in React using the Context API: how to"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:description" content="Learn how to build and leverage feature flags (or feature toggles) in React to improve both the development/release workflow and the user experience."/><meta data-react-helmet="true" property="og:title" content="Build feature flags in React using the Context API: how to"/><meta data-react-helmet="true" name="description" content="Learn how to build and leverage feature flags (or feature toggles) in React to improve both the development/release workflow and the user experience."/><meta name="generator" content="Gatsby 4.10.3"/><style data-href="/styles.be4f4c08059a6854d368.css" data-identity="gatsby-global-css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--grey-1:#243342;--grey-2:#536273;--grey-3:#6c7888;--grey-4:#f8f8f8;--grey-5:#e6e6e6;--white:#fff;--pink:#d03a84;--purple:#6951a1;--orange-1:#f05672;--orange-2:#f47a61;--main-font-color:var(--grey-1);--monospace-font-family:"Inconsolata",monospace;--body-font-family:"Inconsolata",monospace;--title-font-family:"Poppins",sans-serif;--blog-font-family:"Merriweather",sans-serif}body{color:var(--main-font-color);font-family:var(--body-font-family);font-size:20px;font-weight:400;line-height:26px}h1,h2,h3,h4,h5{font-family:var(--title-font-family);font-weight:400;line-height:2rem}@media (max-width:425px){h1{font-size:24px}}h1{line-height:45px}a{color:var(--pink)}a:hover{background-color:var(--purple);color:var(--white)}a.anchor{fill:var(--pink);vertical-align:middle}a.anchor>svg{height:1em;width:1em}a.anchor:hover{background-color:transparent}blockquote{border-left:.25em solid var(--grey-5);color:var(--grey-3);margin:0;padding:0 1em}hr{background-color:var(--grey-5);border:0;height:.25em;margin:24px 0;padding:0}code[class*=language-],pre[class*=language-]{border-radius:6px;font-family:var(--monospace-font-family)!important}:not(pre)>code[class*=language-]{padding:3px 5px!important}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Bio-module--container--CTV0B{font-size:20px;margin-bottom:40px}.HeaderNavigation-module--container--yXex0{align-items:flex-start;display:flex;justify-content:space-between}.HeaderNavigation-module--textLinks--tPGE9{font-size:18px}@media only screen and (max-width:767px){.HeaderNavigation-module--container--yXex0{align-items:center;display:flex;flex-direction:row}}.HeaderNavigation-module--list--WF89i{-webkit-padding-start:0;padding-inline-start:0;text-align:center}.HeaderNavigation-module--navElement--HZCf2{display:inline;list-style-type:none;padding-right:20px}.HeaderNavigation-module--navElement--HZCf2:last-child{padding-right:0}.PrintLinks-module--container--ObbjZ{-webkit-padding-start:0;display:flex;justify-content:space-between;padding-inline-start:0}.PrintLinks-module--container--ObbjZ>li{display:inline;padding-right:15px}.PrintLinks-module--container--ObbjZ>li:last-of-type{padding-right:0}.Header-module--container--9\+PLF{display:flex;flex-direction:column;margin:0}.Header-module--container--9\+PLF nav{width:100%}.Header-module--author--eufK8{margin:15px 0 0;text-align:center}.Header-module--author--eufK8 a{color:var(--grey-1);font-size:30px;margin-bottom:10px;margin-top:10px;text-decoration:none}.Header-module--author--eufK8 a:hover{color:var(--white)}@media only screen and (min-width:768px){.Header-module--container--9\+PLF{margin:20px 0}.Header-module--author--eufK8{text-align:left}}.Footer-module--footer--UZpYC{color:var(--grey-3);display:flex;flex-direction:column;font-size:14px;margin:40px 0;padding-top:20px;text-align:center}@media print{.Footer-module--footer--UZpYC{display:none}}.Layout-module--container--Fywx2{margin:auto}@media only screen and (max-width:767px){.Layout-module--container--Fywx2{font-size:16px;line-height:26px;margin-left:10px;margin-right:10px}}@media only screen and (min-width:768px){.Layout-module--container--Fywx2{max-width:720px}}@media only screen and (min-width:992px){.Layout-module--container--Fywx2{max-width:960px}}@media print{hr{display:none}}.Post-module--postTitle--T9cR2{font-size:20px;font-weight:300;margin-bottom:20px;margin-top:0}.Post-module--date--9cLgl{color:var(--grey-3)}.Post-module--postDescription--D-tma{font-size:18px;line-height:1.5;margin-bottom:10px;margin-top:5px}.blog-module--list--rOrp8{list-style:none;margin:0;padding:0}.Cta-module--button--mk0Yn{background:linear-gradient(to right,var(--purple) 50%,var(--pink) 50%);background-position:100% 100%;background-size:200% 100%;border:0;border-radius:2px;color:var(--white);cursor:pointer;font-family:var(--title-font-family);font-size:14px;font-weight:400;padding:5px 10px;text-decoration:none;transition:background .4s ease-out}.Cta-module--button--mk0Yn:hover{background-position:0 100%;color:var(--white)}.AboutMe-module--container--C412g{align-items:center;display:flex;flex-direction:column;text-align:center}.AboutMe-module--content--dX9KD p{color:var(--grey-2)}.AboutMe-module--img--6vy6i{border-radius:50%}.AboutMe-module--getCv--VLeHB{margin-top:15px}@media print{.AboutMe-module--getCv--VLeHB{display:none}h1{font-size:20px}}.SideProject-module--description--2c8g9{margin-left:20px}.SectionTitle-module--title--kIcoL{border-bottom:1px solid var(--pink);color:var(--pink);font-size:20px;letter-spacing:1.5px;margin-bottom:30px;padding:20px 0 10px;text-transform:uppercase}.SideProjectsListSection-module--list--lK4Gi{-webkit-padding-start:0;list-style-type:none;padding-inline-start:0}.ExpandButton-module--button--MbqRE{background-color:transparent;border:none;color:var(--grey-3);cursor:pointer;font-size:25px;outline:none;padding:0 0 15px;width:100%}.ExpandButton-module--arrow--BK0Ip{border-bottom:3px solid var(--grey-3);border-radius:2px;border-right:3px solid var(--grey-3);cursor:pointer;height:10px;margin:0 auto;width:10px}.ExpandButton-module--arrowDown--QcOwo{-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ExpandButton-module--arrowUp--h72Yt{-webkit-transform:rotate(-135deg);transform:rotate(-135deg)}.WorkExperience-module--container--hGjTh{border-bottom:1px solid var(--grey-5);padding:0 5px}.WorkExperience-module--container--hGjTh ul{-webkit-padding-start:20px;padding-inline-start:20px}.WorkExperience-module--head--NpAt7{display:flex;flex-direction:column;justify-content:space-between}.WorkExperience-module--printContent--MCVJ5{display:none}.WorkExperience-module--screenContent--4sIR7{display:inherit}@media only screen and (min-width:768px){.WorkExperience-module--head--NpAt7{display:grid;grid-template-columns:25% 55% 20%}}@media print{.WorkExperience-module--container--hGjTh{border-bottom:none}.WorkExperience-module--head--NpAt7{display:grid;grid-template-columns:25% 50% 25%;page-break-after:avoid}.WorkExperience-module--printContent--MCVJ5{display:inherit}.WorkExperience-module--screenContent--4sIR7{display:none}}.WorkExperience-module--content--RMeCE{color:var(--grey-2)}.WorkExperience-module--title--\+0D0Y{color:var(--pink);font-size:16px;text-transform:uppercase}.WorkExperience-module--dates--kdmkO{color:var(--grey-3)}.WorkExperience-module--expandSection--ipHDB{text-align:center}.BlogPost-module--container--1Jk04{font-family:var(--body-font-family);font-size:18px}.BlogPost-module--title--9aQtO{background-color:var(--purple);color:var(--white);padding:5px}.BlogPost-module--date--esjRZ{color:var(--grey-3);font-size:16px}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=a8bc7e4821fd384e9e062a484b40ae1f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a8bc7e4821fd384e9e062a484b40ae1f"/><link as="font" href="https://fonts.gstatic.com/s/inconsolata/v21/QlddNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLyya15IDhunA.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/inconsolata/v21/QlddNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLyx615IDhunJ_o.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/inconsolata/v21/QlddNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLyxq15IDhunJ_o.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/poppins/v19/pxiByp8kv8JHgFVrLDz8Z11lFd2JQEl8qw.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/poppins/v19/pxiByp8kv8JHgFVrLDz8Z1JlFd2JQEl8qw.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/poppins/v19/pxiByp8kv8JHgFVrLDz8Z1xlFd2JQEk.woff2" rel="preload" crossorigin="anonymous"/><link as="font" href="https://fonts.gstatic.com/s/poppins/v19/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2" rel="preload" crossorigin="anonymous"/><title data-react-helmet="true">Build feature flags in React using the Context API: how to | Riccardo Coppola</title><link data-react-helmet="true" rel="preconnect" href="https://fonts.googleapis.com"/><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@300;400;700&amp;family=Merriweather:wght@300&amp;family=Poppins:wght@300;400&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/webpack-runtime-4dcffb36acf53f880db0.js"/><link as="script" rel="preload" href="/framework-7b974518e1239d5d48d9.js"/><link as="script" rel="preload" href="/app-4bed2f7a9bbe3b78bbf8.js"/><link as="script" rel="preload" href="/commons-f76493115e4cf5f24dc4.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-tsx-afe35339db93bcb2175f.js"/><link as="fetch" rel="preload" href="/page-data/blog/how-to-build-feature-flags-react/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--container--Fywx2 BlogPost-module--container--1Jk04"><header class="Header-module--container--9+PLF"><h1 class="Header-module--author--eufK8"><a href="/blog">Riccardo Coppola</a></h1><nav><div class="HeaderNavigation-module--container--yXex0"><ul class="HeaderNavigation-module--list--WF89i HeaderNavigation-module--textLinks--tPGE9"><li class="HeaderNavigation-module--navElement--HZCf2"><a href="/blog">Blog</a></li><li class="HeaderNavigation-module--navElement--HZCf2"><a href="/">Profile</a></li></ul><ul class="HeaderNavigation-module--list--WF89i"><li class="HeaderNavigation-module--navElement--HZCf2"><a href="https://github.com/ricca509" class="social-icon" style="display:inline-block;width:30px;height:30px;position:relative;overflow:hidden;vertical-align:middle" aria-label="github"><div class="social-container" style="position:absolute;top:0;left:0;width:100%;height:100%"><svg class="social-svg" style="border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;fill-rule:evenodd" viewBox="0 0 64 64"><g class="social-svg-background" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:transparent"><circle cx="32" cy="32" r="31"></circle></g><g class="social-svg-icon" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#6c7888"><path d="M32,16c-8.8,0-16,7.2-16,16c0,7.1,4.6,13.1,10.9,15.2 c0.8,0.1,1.1-0.3,1.1-0.8c0-0.4,0-1.4,0-2.7c-4.5,1-5.4-2.1-5.4-2.1c-0.7-1.8-1.8-2.3-1.8-2.3c-1.5-1,0.1-1,0.1-1 c1.6,0.1,2.5,1.6,2.5,1.6c1.4,2.4,3.7,1.7,4.7,1.3c0.1-1,0.6-1.7,1-2.1c-3.6-0.4-7.3-1.8-7.3-7.9c0-1.7,0.6-3.2,1.6-4.3 c-0.2-0.4-0.7-2,0.2-4.2c0,0,1.3-0.4,4.4,1.6c1.3-0.4,2.6-0.5,4-0.5c1.4,0,2.7,0.2,4,0.5c3.1-2.1,4.4-1.6,4.4-1.6 c0.9,2.2,0.3,3.8,0.2,4.2c1,1.1,1.6,2.5,1.6,4.3c0,6.1-3.7,7.5-7.3,7.9c0.6,0.5,1.1,1.5,1.1,3c0,2.1,0,3.9,0,4.4 c0,0.4,0.3,0.9,1.1,0.8C43.4,45.1,48,39.1,48,32C48,23.2,40.8,16,32,16z"></path></g><g class="social-svg-mask" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#fff"><path d="M0,0v64h64V0H0z M37.1,47.2c-0.8,0.2-1.1-0.3-1.1-0.8c0-0.5,0-2.3,0-4.4c0-1.5-0.5-2.5-1.1-3 c3.6-0.4,7.3-1.7,7.3-7.9c0-1.7-0.6-3.2-1.6-4.3c0.2-0.4,0.7-2-0.2-4.2c0,0-1.3-0.4-4.4,1.6c-1.3-0.4-2.6-0.5-4-0.5 c-1.4,0-2.7,0.2-4,0.5c-3.1-2.1-4.4-1.6-4.4-1.6c-0.9,2.2-0.3,3.8-0.2,4.2c-1,1.1-1.6,2.5-1.6,4.3c0,6.1,3.7,7.5,7.3,7.9 c-0.5,0.4-0.9,1.1-1,2.1c-0.9,0.4-3.2,1.1-4.7-1.3c0,0-0.8-1.5-2.5-1.6c0,0-1.6,0-0.1,1c0,0,1,0.5,1.8,2.3c0,0,0.9,3.1,5.4,2.1 c0,1.3,0,2.3,0,2.7c0,0.4-0.3,0.9-1.1,0.8C20.6,45.1,16,39.1,16,32c0-8.8,7.2-16,16-16c8.8,0,16,7.2,16,16 C48,39.1,43.4,45.1,37.1,47.2z"></path></g></svg></div></a></li><li class="HeaderNavigation-module--navElement--HZCf2"><a href="https://www.linkedin.com/in/riccardocoppola/" class="social-icon" style="display:inline-block;width:30px;height:30px;position:relative;overflow:hidden;vertical-align:middle" aria-label="linkedin"><div class="social-container" style="position:absolute;top:0;left:0;width:100%;height:100%"><svg class="social-svg" style="border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;fill-rule:evenodd" viewBox="0 0 64 64"><g class="social-svg-background" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:transparent"><circle cx="32" cy="32" r="31"></circle></g><g class="social-svg-icon" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#6c7888"><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z"></path></g><g class="social-svg-mask" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#fff"><path d="M0,0v64h64V0H0z M25.8,44h-5.4V26.6h5.4V44z M23.1,24.3c-1.7,0-3.1-1.4-3.1-3.1c0-1.7,1.4-3.1,3.1-3.1 c1.7,0,3.1,1.4,3.1,3.1C26.2,22.9,24.8,24.3,23.1,24.3z M46,44h-5.4v-8.4c0-2,0-4.6-2.8-4.6c-2.8,0-3.2,2.2-3.2,4.5V44h-5.4V26.6 h5.2V29h0.1c0.7-1.4,2.5-2.8,5.1-2.8c5.5,0,6.5,3.6,6.5,8.3V44z"></path></g></svg></div></a></li><li class="HeaderNavigation-module--navElement--HZCf2"><a href="https://500px.com/ricca509" class="social-icon" style="display:inline-block;width:30px;height:30px;position:relative;overflow:hidden;vertical-align:middle" aria-label="fivehundredpix"><div class="social-container" style="position:absolute;top:0;left:0;width:100%;height:100%"><svg class="social-svg" style="border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;fill-rule:evenodd" viewBox="0 0 64 64"><g class="social-svg-background" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:transparent"><circle cx="32" cy="32" r="31"></circle></g><g class="social-svg-icon" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#6c7888"><path d="M42.9,27.6c-2.1,0-3.6,1-5.8,3.5c-1.9-2.5-3.8-3.5-5.8-3.5c-1.7,0-3.7,0.7-4.7,3.2 c-1-2-2.7-2.6-4.1-2.6c-1,0-2,0.2-2.9,1.1l0.6-3.3h6.2v-2.5h-8.4l-1.5,8v0.2h2.7c0.6-1,1.5-1.2,2.3-1.2c1.2,0,2.3,0.6,2.6,2.4v0.7 c-0.2,1.6-1.3,2.6-2.6,2.6c-1.1,0-2.3-0.6-2.4-2.2h-3v0.7c0,0.3,0.5,1.5,0.5,1.6c1.3,2.1,3.4,2.5,5,2.5c1.8,0,3.9-0.7,5.1-3.2 c1.1,2.4,3,3.1,4.8,3.1c2.1,0,3.5-0.9,5.7-3.3c1.9,2.3,3.7,3.3,5.7,3.3c3.4,0,5.1-2.6,5.1-5.6C48,30,46.2,27.6,42.9,27.6z  M34.7,33.7c-0.4,0.4-1,0.9-1.4,1.1c-0.7,0.4-1.3,0.6-1.9,0.6c-0.6,0-1.7-0.4-2.1-1.3c-0.1-0.2-0.2-0.6-0.2-0.7v-0.9 c0.3-1.5,1.1-2.1,2.2-2.1c0.1,0,0.6,0,0.9,0.1c0.4,0.1,0.7,0.3,1.1,0.6c0.4,0.3,2,1.6,2,1.8C35.3,33.2,34.9,33.5,34.7,33.7z  M42.9,35.5c-1.3,0-2.6-0.9-3.9-2.3c1.4-1.5,2.5-2.6,3.8-2.6c1.5,0,2.3,1.1,2.3,2.5C45.2,34.4,44.4,35.5,42.9,35.5z"></path></g><g class="social-svg-mask" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#fff"><path d="M33.3,31.3c-0.4-0.2-0.7-0.4-1.1-0.6c-0.3-0.1-0.8-0.1-0.9-0.1c-1.1,0-1.9,0.6-2.2,2.1v0.9c0,0.1,0.1,0.4,0.2,0.7 c0.3,0.9,1.4,1.3,2.1,1.3s1.2-0.2,1.9-0.6c0.5-0.3,1-0.7,1.4-1.1c0.2-0.2,0.5-0.5,0.5-0.6C35.3,32.8,33.7,31.6,33.3,31.3z  M42.8,30.6c-1.3,0-2.4,1-3.8,2.6c1.3,1.5,2.6,2.3,3.9,2.3c1.5,0,2.2-1.1,2.2-2.4C45.2,31.7,44.3,30.6,42.8,30.6z M0,0v64h64V0H0z  M42.9,38.5c-2,0-3.8-1-5.7-3.3c-2.2,2.4-3.7,3.3-5.7,3.3c-1.8,0-3.7-0.7-4.8-3.1c-1.2,2.5-3.3,3.2-5.1,3.2c-1.6,0-3.8-0.4-5-2.5 C16.5,36,16,34.8,16,34.5v-0.7h3c0.1,1.6,1.3,2.2,2.4,2.2c1.3,0,2.4-0.9,2.6-2.6v-0.7c-0.2-1.8-1.3-2.4-2.6-2.4 c-0.8,0-1.6,0.2-2.3,1.2h-2.7v-0.2l1.5-8h8.4v2.5h-6.2l-0.6,3.3c1-0.9,2-1.1,2.9-1.1c1.4,0,3.2,0.6,4.1,2.6c1-2.4,3-3.2,4.7-3.2 c2,0,3.9,1,5.8,3.5c2.1-2.6,3.7-3.5,5.8-3.5c3.3,0,5.1,2.4,5.1,5.4C48,35.9,46.2,38.5,42.9,38.5z"></path></g></svg></div></a></li><li class="HeaderNavigation-module--navElement--HZCf2"><a href="mailto:riccardo@onefiniteloop.io" class="social-icon" style="display:inline-block;width:30px;height:30px;position:relative;overflow:hidden;vertical-align:middle" aria-label="mailto"><div class="social-container" style="position:absolute;top:0;left:0;width:100%;height:100%"><svg class="social-svg" style="border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;fill-rule:evenodd" viewBox="0 0 64 64"><g class="social-svg-background" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:transparent"><circle cx="32" cy="32" r="31"></circle></g><g class="social-svg-icon" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#6c7888"><path d="M17,22v20h30V22H17z M41.1,25L32,32.1L22.9,25H41.1z M20,39V26.6l12,9.3l12-9.3V39H20z"></path></g><g class="social-svg-mask" style="-ms-transition:fill 170ms ease-in-out;-o-transition:fill 170ms ease-in-out;-moz-transition:fill 170ms ease-in-out;-webkit-transition:fill 170ms ease-in-out;transition:fill 170ms ease-in-out;fill:#fff"><path d="M41.1,25H22.9l9.1,7.1L41.1,25z M44,26.6l-12,9.3l-12-9.3V39h24V26.6z M0,0v64h64V0H0z M47,42H17V22h30V42z"></path></g></svg></div></a></li></ul></div></nav></header><div><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 class="BlogPost-module--title--9aQtO" itemProp="headline">Build feature flags in React using the Context API: how to</h1><p class="BlogPost-module--date--esjRZ">March 29, 2020</p></header><section itemProp="articleBody"><p><em>One of the tenets of lean development is “deliver fast, deliver often”.</em></p>
<p><em>Now, this can become tricky when you have to add new, big features to an application that is already live, or you have to delay a release to a specific day (e.g. changing the landing page for a big sale).</em></p>
<p><em>How can we build (and leverage) <a href="https://martinfowler.com/articles/feature-toggles.html">feature flags (or feature toggles)</a> to improve both the development/release workflow and the user experience?</em></p>
<h2 id="the-case-for-releasing-features-in-the-dark" style="position:relative;"><a href="#the-case-for-releasing-features-in-the-dark" aria-label="the case for releasing features in the dark permalink" class="anchor before"><svg height="20" width="20" viewBox="-32 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg></a>The case for releasing features “in the dark”</h2>
<p>Suppose you have a successful, high traffic blog built in React and you want to add a list of featured posts at the top. The first step would be to break this feature or epic down into smaller stories with your team.</p>
<p>Let’s assume that these are the stories you come up with:</p>
<ul>
<li>create an empty container for the featured posts</li>
<li>display a list of unstyled posts</li>
<li>add style to the list of posts</li>
<li>add UX behaviour to the list of posts, such as a link to the post page and author page</li>
</ul>
<p>You can expect to have other work ongoing in parallel, like maintaining the blog, making small UI changes etc so how do you handle this big feature release? You definitely cannot go live with an empty container at the top of the page, or with a list of unstyled text that has no behaviour.</p>
<p>One solution may be to create a long-living branch that you rebase on to master as often as you manage to remember (and fix all the conflicts every time), and build the whole feature there, then do a big-bang release of all the code. I don’t need to go on to explain why this is a bad decision on so many levels.</p>
<p><strong>Another solution is to use feature flags to wrap your new feature so that you release the code to production as often as you want, following your usual development/release workflow, you just don’t display it to the user.</strong></p>
<p>Following is an example:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// This configuration can come from wherever you prefer:</span>
<span class="token comment">// a config file, a mongo database, etc</span>
<span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">featuredPosts</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// In your react component</span>
<span class="token keyword">import</span> FeaturedPosts <span class="token keyword">from</span> <span class="token string">"./featured-posts"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">HomePage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> features <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span><span class="token plain-text">
      // ... other content
      </span><span class="token punctuation">{</span>features<span class="token punctuation">.</span>featuredPosts <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FeaturedPosts</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
      // ... other content
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>So the idea behind feature flags is to ship code “in the dark”, without the user seeing it.<br>
This way you can keep your big feature within your normal development/delivery flow, just hidden from the final users.</p>
<h2 id="react-implementation" style="position:relative;"><a href="#react-implementation" aria-label="react implementation permalink" class="anchor before"><svg height="20" width="20" viewBox="-32 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg></a>React implementation</h2>
<p>I want to create a small component to wrap content with so that I can decide whether or not to render it based on the value of a feature flag.</p>
<p>To keep this as simple as possible, the following is the way I see this component being used:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> FeaturedPosts <span class="token keyword">from</span> <span class="token string">"./featured-posts"</span><span class="token punctuation">;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Feature</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>featuredPosts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FeaturedPosts</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Feature</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span></code></pre></div>
<p>This is a very declarative, React-like way of consuming features.</p>
<p>Where do I get the features’ list from, though? And what a possible implementation may look like?</p>
<p><a href="https://reactjs.org/docs/context.html">React Context</a> can help inject a list of features into the application and retrieve it later, as for the component implementation, let’s have a look:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> createContext<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> FeaturesContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> FeaturesProvider <span class="token operator">=</span> FeaturesContext<span class="token punctuation">.</span>Provider<span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Feature</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> flags <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>FeaturesContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> flags<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">?</span> children <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>First of all, I am creating a <code class="language-text">FeaturesContext</code> to be used later to wrap my app.</p>
<p>The <code class="language-text">Feature</code> component then takes the feature’s name and the children and based on the boolean state of the feature, it’ll either render the children (if the feature is enabled) or <code class="language-text">null</code>. It can do it because it’s got access to the list of feature flags from the context.</p>
<p>Following is a usage example:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> FeaturedPosts <span class="token keyword">from</span> <span class="token string">"./featured-posts"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">HomePage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      /* other content */
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Feature</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>featuredPosts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FeaturedPosts</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Feature</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      /* other content */
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">featuredPosts</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FeaturesProvider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>features<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">HomePage</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">FeaturesProvider</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="adding-mvt-multivariate-testing-support" style="position:relative;"><a href="#adding-mvt-multivariate-testing-support" aria-label="adding mvt multivariate testing support permalink" class="anchor before"><svg height="20" width="20" viewBox="-32 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg></a>Adding MVT (MultiVariate Testing) support</h2>
<p>The use case for MVT is when you want to try out different variations of the same feature (e.g. trying out three different colors for call to action buttons) to see which one is the best performer.</p>
<p>We can easily extend the <code class="language-text">Feature</code> component to support MVT by adding a <code class="language-text">variation</code> property:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Feature</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> variation<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> flags <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>FeaturesContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>children<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>variation <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> flags<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">?</span> children <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> flags<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">===</span> variation <span class="token operator">?</span> children <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>In the code above, if we don’t receive a <code class="language-text">variation</code>, we treat the flag as a <code class="language-text">Boolean</code> otherwise we only render the correct variation.</p>
<h2 id="thoughts-on-deployment-environments" style="position:relative;"><a href="#thoughts-on-deployment-environments" aria-label="thoughts on deployment environments permalink" class="anchor before"><svg height="20" width="20" viewBox="-32 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg></a>Thoughts on deployment environments</h2>
<p>Many projects are deployed through a series of environments (dev, staging, pre-prod, <em>add your name here</em>) before being released to production.</p>
<p>This can allow for additional levels of testing, usually E2E tests, to be carried out. You can fully test the code behind a feature flag by having different settings for different environments: one of the practices that I’d use is to have all features enabled on a staging environment and run all level of tests against them, then have them turned off in pre-prod and prod.</p>
<p>This way you have the confidence of having well-tested features and the ability to keep them hidden until it’s release time.</p>
<h2 id="feature-flags-and-technical-debt" style="position:relative;"><a href="#feature-flags-and-technical-debt" aria-label="feature flags and technical debt permalink" class="anchor before"><svg height="20" width="20" viewBox="-32 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg></a>Feature flags and technical debt</h2>
<p>Technical debt is a reality in every application we build. It can be kept under control, but real-life scenarios call for technical debt to be created in order to deliver faster in some periods or accommodate for temporary business requirements.</p>
<p>It is like a loan: you need it, but you also need to have a plan in place to pay it back.</p>
<p>Feature flags add to technical debt because they are part of the code only for a short amount of time and need to be removed afterwards, without actually being a user feature.</p>
<p>This doesn’t mean they shouldn’t be used, the opposite actually, but there must be a plan in place to clean up the code: every time you use them, make sure your stories include points about removing the feature flag wrapping your code and update the tests to reflect the presence of the feature, plus anything else you may have to do.</p>
<p>Enjoy your improved workflow!</p></section><hr/><footer><div class="Bio-module--container--CTV0B">Notes on web development, life, learning and the world.</div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/replace-redux-with-react-hooks-and-context-api/">← <!-- -->Replace Redux with React Hooks and the Context API: how to and code</a></li><li></li></ul></nav></main><footer class="Footer-module--footer--UZpYC"><p>© <!-- -->2022<!-- --> Riccardo Coppola</p><p>This application is built with<!-- --> <a href="https://www.gatsbyjs.org/" alt="Gatsby link">Gatsby</a> <!-- -->and hosted on GitHub pages, take a look at the<!-- --> <a href="https://github.com/ricca509/ricca509.github.io" alt="GitHub repository" target="blank">source code on GitHub</a>.</p></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-156846806-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/how-to-build-feature-flags-react/";window.___webpackCompilationHash="a44467b1ca96c680db72";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-415d0a1b5a3d1bc686e8.js"],"app":["/app-4bed2f7a9bbe3b78bbf8.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-ffc0300915f8765ca95d.js"],"component---src-pages-blog-tsx":["/component---src-pages-blog-tsx-366b924ace4398f4865c.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-876965a787eb5a76f334.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-afe35339db93bcb2175f.js"]};/*]]>*/</script><script src="/polyfill-415d0a1b5a3d1bc686e8.js" nomodule=""></script><script src="/component---src-templates-blog-post-tsx-afe35339db93bcb2175f.js" async=""></script><script src="/commons-f76493115e4cf5f24dc4.js" async=""></script><script src="/app-4bed2f7a9bbe3b78bbf8.js" async=""></script><script src="/framework-7b974518e1239d5d48d9.js" async=""></script><script src="/webpack-runtime-4dcffb36acf53f880db0.js" async=""></script></body></html>